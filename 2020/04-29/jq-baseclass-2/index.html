<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo-loki.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"summer10920.github.io","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","width":370,"display":"post","padding":20,"offset":20,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>


  <meta name="description" content="Ajax 是一種非同步的運行資料處理方式，我們都知道網頁瀏覽透過伺服器請求將網頁載到用戶端進行網頁文件讀取。如果還需要做資料處理或請求，則需要重新重整網頁，使得請求後端伺服器再新生成文件並傳送到用戶端進行文件讀取。">
<meta property="og:type" content="article">
<meta property="og:title" content="[基礎課程] jQuery 教學（二）：Ajax 技術">
<meta property="og:url" content="http://summer10920.github.io/2020/04-29/jq-baseclass-2/">
<meta property="og:site_name" content="洛奇的邪惡組織手札">
<meta property="og:description" content="Ajax 是一種非同步的運行資料處理方式，我們都知道網頁瀏覽透過伺服器請求將網頁載到用戶端進行網頁文件讀取。如果還需要做資料處理或請求，則需要重新重整網頁，使得請求後端伺服器再新生成文件並傳送到用戶端進行文件讀取。">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2020-04-29T09:22:05.000Z">
<meta property="article:modified_time" content="2020-05-08T11:05:24.000Z">
<meta property="article:author" content="Loki Jiang">
<meta property="article:tag" content="PHP 資料庫網頁設計（職前班）">
<meta property="article:tag" content="JavaScript 程式設計（假日班）">
<meta property="article:tag" content="前端網頁開發技術（職前班）">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://summer10920.github.io/2020/04-29/jq-baseclass-2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>[基礎課程] jQuery 教學（二）：Ajax 技術 | 洛奇的邪惡組織手札</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146423952-3"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-146423952-3');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">洛奇的邪惡組織手札</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">I am WebDeveloper!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>標籤<span class="badge">8</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分類<span class="badge">10</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>所有文章<span class="badge">41</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋內文
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/summer10920" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://summer10920.github.io/2020/04-29/jq-baseclass-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/loki_img.jpg">
      <meta itemprop="name" content="Loki Jiang">
      <meta itemprop="description" content="Time waits for no oneヽ(｀Д´)ﾉ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洛奇的邪惡組織手札">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [基礎課程] jQuery 教學（二）：Ajax 技術
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-04-29 17:22:05" itemprop="dateCreated datePublished" datetime="2020-04-29T17:22:05+08:00">2020-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-05-08 19:05:24" itemprop="dateModified" datetime="2020-05-08T19:05:24+08:00">2020-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%81%B7%E8%A8%93%E6%95%99%E6%9D%90/" itemprop="url" rel="index"><span itemprop="name">職訓教材</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%81%B7%E8%A8%93%E6%95%99%E6%9D%90/jQuery/" itemprop="url" rel="index"><span itemprop="name">jQuery</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="閱讀次數" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">閱讀次數：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Ajax 是一種非同步的運行資料處理方式，我們都知道網頁瀏覽透過伺服器請求將網頁載到用戶端進行網頁文件讀取。如果還需要做資料處理或請求，則需要重新重整網頁，使得請求後端伺服器再新生成文件並傳送到用戶端進行文件讀取。</p>
<a id="more"></a>

<p>Ajax 簡單來說就是將這些動作包在一起，當你閱讀目前頁面時，透過 JavaScript 在背後呼叫執行 B 頁面但你未察覺到，而將 B 頁面的資訊取得之後，重新 DOM 控制改寫 A 頁面的內容。通常會使用 Ajax 的場合都是處於需要從某處 (Database or api) 進行資料請求 (get data) 或是資料處理 (pusb data)。</p>
<p>最經典的案例就是 Gmail 介面，網頁不用重新加載就能立即性的看見任何結果，該 HTML 會根據你任何操作直接抽換 DOM 給你，使得網頁就像活現的線上應用程式那樣使用。</p>
<hr>
<h1 id="語法說明"><a href="#語法說明" class="headerlink" title="語法說明"></a>語法說明</h1><p>JavaScript 的 Ajax 相對來說比較複雜且完整參數指令（可自行查 MDN 網站了解），jQuery 的 Ajax 則大幅簡化程式且提供多種方法，只要輕鬆的指令 ava 就 cript 能控制。主分以下方法與用途：</p>
<table>
<thead>
<tr>
<th>語法</th>
<th>說明</th>
</tr>
</thead>
<tbody><tr>
<td>$(selector).load(url)</td>
<td>對 selector 進行載入 url 之 HTML 並替換內容</td>
</tr>
<tr>
<td>$.get(url,data,callback)</td>
<td>以 get 概念傳送 data 到 url 提供取得，並透過 callback 取得執行指令與 url 結果</td>
</tr>
<tr>
<td>$.post(url,data,callback)</td>
<td>同上，但是以 postt 概念傳送 data 到 url</td>
</tr>
<tr>
<td>$.getJSON(url,data,success(data,status,xhr))</td>
<td>同 get 概念，可從 url 取得 JSON 格式 (API) 之資料，並提供相關 success 請求參數</td>
</tr>
<tr>
<td>$.getScript(url,data,success(data,status,xhr))</td>
<td>同上，主要是取得 JSONP 格式為用途</td>
</tr>
<tr>
<td>$.ajax(setting)</td>
<td>完整的 Ajax 控制語法，setting 為多資料之物件結構陣列。前幾項都是簡化過的 Ajax()</td>
</tr>
</tbody></table>
<p>這裡基礎教學重點為、$.get() 與、$.post()，之後的 API 串接會再深入介紹。</p>
<h2 id="get-vs-post"><a href="#get-vs-post" class="headerlink" title="$.get() vs $.post()"></a>$.get() vs $.post()</h2><p>你如果能理解一般表單進行資料提交或存取時，你可以選擇 get 或 post 方式，透過該超全域變數進行資料傳遞，在 Ajax 也是同樣原理提交變數到另一個網頁去，。基本語法結過如下（以 post 為例，get 不再重複解釋）</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.post(url,data,callback,type);</span><br><span class="line"><span class="comment">//url 目標網址，將資料送給何者網頁</span></span><br><span class="line"><span class="comment">//data 為傳遞的變數透過 post/get 轉為超全域變數，能以 JSON 陣列塞入多筆資料</span></span><br><span class="line"><span class="comment">//callback 指定當回傳資料時執行函式，通常會在這裡進行 DOM 變化</span></span><br><span class="line"><span class="comment">//能指定回傳的型態 (HTML,XML,JSON...)，預設會自動判別</span></span><br></pre></td></tr></table></figure>

<p>這是前者屬於簡化後的$.post 用法，同等於後者完整的$.Ajax 用法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">  type: <span class="string">'POST'</span>,</span><br><span class="line">  url: url,</span><br><span class="line">  data: data,</span><br><span class="line">  success: callback,<span class="comment">//可以指定函式或匿名函式</span></span><br><span class="line">  dataType: dataType <span class="comment">//可省略不寫</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="題目練習"><a href="#題目練習" class="headerlink" title="題目練習"></a>題目練習</h1><p>這裡我們將扮演一個前端角色，透過 Ajax 方式向後端申請畫面所需之數據，請後端提供已是 HTML 的內容代碼，讓前端取得並只需要 DOM 生成即可（或者是向後端取得數據陣列，由前端負責組成 HTML 代碼再完成 DOM 生成）。這裡的題目練習為資料庫內有動物資料表、透過 Ajax 方式直接進行 CURD 四步驟。</p>
<h2 id="版型規劃與前置作業"><a href="#版型規劃與前置作業" class="headerlink" title="版型規劃與前置作業"></a>版型規劃與前置作業</h2><p>由於需要一個後端程式 (PHP) 與資料庫 (MySQL) 並搭配 PDO 方式連接，如果你本身已會此兩項技能可自行參考本事前準備之相關環境，否則請於上課時採用老師的後端環境（由老師提供後端環境）。DOM 操作與 Ajax 部分我們依賴 jQuery 來快速套用。</p>
<h3 id="後端準備"><a href="#後端準備" class="headerlink" title="後端準備"></a>後端準備</h3><div class="note primary">
            <p><strong>後端準備：提供以下代碼給有能力自行架設之學員</strong> </p><ol><li>MySQL 匯入：並另提供讀寫權限（範例為 test/test)，將得到資料庫/表為 jq_sample/ajax_animal。<figure class="highlight sql"><figcaption><span>db.sql (MySQL)</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">-- phpMyAdmin SQL Dump</span></span><br><span class="line"><span class="comment">-- version 4.8.5</span></span><br><span class="line"><span class="comment">-- https://www.phpmyadmin.net/</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 主機： 127.0.0.1</span></span><br><span class="line"><span class="comment">-- 產生時間： </span></span><br><span class="line"><span class="comment">-- 伺服器版本： 10.1.40-MariaDB</span></span><br><span class="line"><span class="comment">-- PHP 版本： 7.3.5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> SQL_MODE = <span class="string">"NO_AUTO_VALUE_ON_ZERO"</span>;</span><br><span class="line"><span class="keyword">SET</span> AUTOCOMMIT = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">time_zone</span> = <span class="string">"+00:00"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET NAMES utf8mb4 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 資料庫： `jq_sample`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">`jq_sample`</span> <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci;</span><br><span class="line"><span class="keyword">USE</span> <span class="string">`jq_sample`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 資料表結構 `ajax_animal`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`ajax_animal`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">smallint</span>(<span class="number">5</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">text</span> <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`weight`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`info`</span> <span class="built_in">text</span> <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 傾印資料表的資料 `ajax_animal`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`ajax_animal`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`weight`</span>, <span class="string">`info`</span>, <span class="string">`date`</span>) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">'藪貓'</span>, <span class="number">9</span>, <span class="string">'食肉目 貓科 藪貓屬'</span>, <span class="string">'2020-12-20 08:21:08'</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">'耳廓狐'</span>, <span class="number">17</span>, <span class="string">'食肉目 犬科 狐屬'</span>, <span class="string">'2020-12-19 15:57:56'</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">'河馬'</span>, <span class="number">120</span>, <span class="string">'鯨偶蹄目 河馬科 河馬屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">'印度象'</span>, <span class="number">1258</span>, <span class="string">'長鼻目 象科 象屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">'浣熊'</span>, <span class="number">30</span>, <span class="string">'食肉目 浣熊科 浣熊屬'</span>, <span class="string">'2020-11-07 09:13:58'</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">'斑馬'</span>, <span class="number">53</span>, <span class="string">'奇蹄目 馬科 馬屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">'瞪羚'</span>, <span class="number">32</span>, <span class="string">'鯨偶蹄目 牛科 瞪羚屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">'土狼'</span>, <span class="number">32</span>, <span class="string">'食肉目 鬣狗科 土狼屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">'水獺'</span>, <span class="number">32</span>, <span class="string">'食肉目 鼬科 小爪水獺屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">'美洲豹'</span>, <span class="number">999999</span>, <span class="string">'食肉目 貓科 豹屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">'山貓'</span>, <span class="number">999999999</span>, <span class="string">'食肉目 貓科 虎貓屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">'馬來貘'</span>, <span class="number">80</span>, <span class="string">'奇蹄目 貘科 貘屬'</span>, <span class="string">'2020-11-07 09:13:33'</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">'馬島獴'</span>, <span class="number">17</span>, <span class="string">'食肉目 食蟻狸科 馬島獴屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">'花鹿'</span>, <span class="number">120</span>, <span class="string">'鯨偶蹄目 鹿科 花鹿屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">'眼鏡王蛇'</span>, <span class="number">1258</span>, <span class="string">'有鱗目 眼鏡蛇科 眼鏡王蛇屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">16</span>, <span class="string">'食蟻獸'</span>, <span class="number">40</span>, <span class="string">'披毛目 食蟻獸科 小食蟻獸屬'</span>, <span class="string">'2020-11-07 09:13:58'</span>),</span><br><span class="line">(<span class="number">17</span>, <span class="string">'孔雀'</span>, <span class="number">532</span>, <span class="string">'雞形目 雉科 孔雀屬'</span>, <span class="string">'2020-11-07 10:54:58'</span>),</span><br><span class="line">(<span class="number">18</span>, <span class="string">'袋獾'</span>, <span class="number">32</span>, <span class="string">'袋鼬目 袋鼬科 袋獾屬'</span>, <span class="string">'2020-11-07 10:55:05'</span>),</span><br><span class="line">(<span class="number">19</span>, <span class="string">'傘蜥蜴'</span>, <span class="number">555</span>, <span class="string">'有鱗目 飛蜥科 傘蜥蜴屬'</span>, <span class="string">'2020-11-07 10:55:26'</span>),</span><br><span class="line">(<span class="number">20</span>, <span class="string">'朱䴉'</span>, <span class="number">32</span>, <span class="string">'鵜形目 䴉科 朱䴉屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">21</span>, <span class="string">'羊駝'</span>, <span class="number">999999</span>, <span class="string">'鯨偶蹄目 駱駝科 小羊駝屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">22</span>, <span class="string">'美洲紅䴉'</span>, <span class="number">55</span>, <span class="string">'鵜形目 䴉科 美洲䴉屬'</span>, <span class="string">'2020-11-07 09:22:04'</span>),</span><br><span class="line">(<span class="number">23</span>, <span class="string">'美洲河狸'</span>, <span class="number">55</span>, <span class="string">'嚙齒目 河狸科 河狸屬'</span>, <span class="string">'2020-11-07 09:24:31'</span>),</span><br><span class="line">(<span class="number">24</span>, <span class="string">'黑尾土撥鼠'</span>, <span class="number">999999999</span>, <span class="string">'嚙齒目 松鼠科 草原犬鼠屬'</span>, <span class="string">'2020-11-07 08:52:06'</span>),</span><br><span class="line">(<span class="number">25</span>, <span class="string">'獅子'</span>, <span class="number">55</span>, <span class="string">'食肉目 貓科 豹屬'</span>, <span class="string">'2020-12-20 09:38:19'</span>),</span><br><span class="line">(<span class="number">26</span>, <span class="string">'原牛'</span>, <span class="number">120</span>, <span class="string">'鯨偶蹄目 牛科 牛屬'</span>, <span class="string">'2020-12-20 09:39:03'</span>),</span><br><span class="line">(<span class="number">27</span>, <span class="string">'阿拉伯大羚羊'</span>, <span class="number">2223</span>, <span class="string">'鯨偶蹄目 牛科 長角羚屬'</span>, <span class="string">'2020-12-20 09:40:53'</span>),</span><br><span class="line">(<span class="number">28</span>, <span class="string">'日本黑熊'</span>, <span class="number">222</span>, <span class="string">'食肉目 熊科 熊屬'</span>, <span class="string">'2020-12-20 09:49:00'</span>),</span><br><span class="line">(<span class="number">29</span>, <span class="string">'駝鹿'</span>, <span class="number">22</span>, <span class="string">'鯨偶蹄目 鹿科 駝鹿屬'</span>, <span class="string">'2020-12-20 09:50:23'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 已傾印資料表的索引</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 資料表索引 `ajax_animal`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`ajax_animal`</span></span><br><span class="line">  <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 在傾印的資料表使用自動增長 (AUTO_INCREMENT)</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- 使用資料表自動增長 (AUTO_INCREMENT) `ajax_animal`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`ajax_animal`</span></span><br><span class="line">  <span class="keyword">MODIFY</span> <span class="string">`id`</span> <span class="built_in">smallint</span>(<span class="number">5</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT, AUTO_INCREMENT=<span class="number">30</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;</span><br></pre></td></tr></table></figure></li><li>建立 api.php：做為後端的簡易連結處理。<figure class="highlight php"><figcaption><span>api.php (PHP)</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$db = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=127.0.0.1;dbname=jq_sample;charset=utf8"</span>, <span class="string">"test"</span>, <span class="string">"test"</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">'asia/Taipei'</span>);</span><br><span class="line"><span class="comment">// 取得 PDO 物件，另外順便校正 PHP 時差</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 這裡用 switch 是因為還有其他 Ajax 提交，因此利用 GET 來做區分判斷處理。</span></span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">'do'</span>]) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'select'</span>:</span><br><span class="line">    $sql = <span class="string">"SELECT * FROM ajax_animal limit "</span> . $_POST[<span class="string">'start'</span>] . <span class="string">",10"</span>;</span><br><span class="line">    $rows = $db-&gt;query($sql)-&gt;fetchAll();</span><br><span class="line">    <span class="comment">// print_r($_POST);</span></span><br><span class="line">    <span class="comment">// print_r($rows);</span></span><br><span class="line">    <span class="keyword">if</span>($rows)&#123;</span><br><span class="line">      <span class="keyword">foreach</span> ($rows <span class="keyword">as</span> $row) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'</span></span><br><span class="line"><span class="string">          &lt;tr&gt;</span></span><br><span class="line"><span class="string">            &lt;td&gt;'</span> . $row[<span class="string">'id'</span>] . <span class="string">'&lt;/td&gt;</span></span><br><span class="line"><span class="string">            &lt;td class="name"&gt;'</span> . $row[<span class="string">'name'</span>] . <span class="string">'&lt;/td&gt;</span></span><br><span class="line"><span class="string">            &lt;td&gt;'</span> . $row[<span class="string">'weight'</span>] . <span class="string">'&lt;/td&gt;</span></span><br><span class="line"><span class="string">            &lt;td&gt;'</span> . $row[<span class="string">'info'</span>] . <span class="string">'&lt;/td&gt;</span></span><br><span class="line"><span class="string">            &lt;td&gt;'</span> . $row[<span class="string">'date'</span>] . <span class="string">'&lt;/td&gt;</span></span><br><span class="line"><span class="string">            &lt;td&gt;</span></span><br><span class="line"><span class="string">              &lt;button class="mdy"&gt;修改&lt;/button&gt;</span></span><br><span class="line"><span class="string">              &lt;button onclick="del(this)"&gt;刪除&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/td&gt;</span></span><br><span class="line"><span class="string">          &lt;/tr&gt;</span></span><br><span class="line"><span class="string">        '</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">'fail'</span>;</span><br><span class="line">    <span class="comment">// SQL 內取得所有動物資料，由 foreach 規劃完整 tr&gt;td，使前端單純 HTML 替換即可。</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'update'</span>:</span><br><span class="line">    $sql = <span class="string">"UPDATE ajax_animal SET name='"</span> . $_POST[<span class="string">'name'</span>] . <span class="string">"',weight='"</span> . $_POST[<span class="string">'weight'</span>] . <span class="string">"',info='"</span> . $_POST[<span class="string">'info'</span>] . <span class="string">"',date=NOW() WHERE id="</span> . $_POST[<span class="string">'id'</span>];</span><br><span class="line">    $result = $db-&gt;query($sql);</span><br><span class="line">    <span class="comment">// 成功時，我們 HTML 生成所需要的更新日期之文字，透過 Ajax 回傳給前端</span></span><br><span class="line">    <span class="keyword">if</span> ($result) <span class="keyword">echo</span> date(<span class="string">"Y-m-d H:i:s"</span>);</span><br><span class="line">    <span class="comment">// if($result) echo "OK";</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'delete'</span>:</span><br><span class="line">    $sql = <span class="string">"DELETE FROM ajax_animal WHERE id="</span> . $_POST[<span class="string">'id'</span>];</span><br><span class="line">    $result = $db-&gt;query($sql);</span><br><span class="line">    <span class="keyword">if</span> ($result) <span class="keyword">echo</span> <span class="string">"deleted"</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'insert'</span>:</span><br><span class="line">    $sql = <span class="string">"INSERT INTO ajax_animal VALUES(null,'"</span> . $_POST[<span class="string">'name'</span>] . <span class="string">"','"</span> . $_POST[<span class="string">'weight'</span>] . <span class="string">"','"</span> . $_POST[<span class="string">'info'</span>] . <span class="string">"',NOW())"</span>;</span><br><span class="line">    $result = $db-&gt;query($sql);</span><br><span class="line">    <span class="keyword">if</span> ($result) <span class="keyword">echo</span> <span class="string">"inserted"</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>最後，由此代碼可知：</p><ol><li>取凡任何資料請求皆使用 POST 進行變數傳遞，</li><li>同時變數之索引名稱分別為 id, name, weight, info，時間為自動抓取。</li><li>後端採用網址 GET 參數判斷 select, insert, update, delete。</li><li>使用 select 需傳送 start 值，方便撈取固定十筆數量。</li></ol>
          </div>

<h3 id="前端準備"><a href="#前端準備" class="headerlink" title="前端準備"></a>前端準備</h3><p>先設計簡單的 table 畫面，之後隨著 CRUD 的循序設計慢慢豐富此頁面設計。</p>
<figure class="highlight html"><figcaption><span>index.html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>jqajax-animal<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.5.0.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"100%"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>編號<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>動物名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>重量<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>簡介<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>更新日期<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"6"</span>&gt;</span><span class="tag">&lt;<span class="name">hr</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="SELECT-篇：Ajax-資料請求"><a href="#SELECT-篇：Ajax-資料請求" class="headerlink" title="SELECT 篇：Ajax 資料請求"></a>SELECT 篇：Ajax 資料請求</h2><ol>
<li>先確認後端這裡會提供完整的 HTML 代碼給我們，我們不需要自行規劃 HTML。因此前端大致語法如下：<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* $.post 寫法 */</span></span><br><span class="line">$.post(<span class="string">"api.php?do=select"</span>, &#123;start&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  $(<span class="string">"tbody"</span>).html(result);</span><br><span class="line">  $(<span class="string">".mdy"</span>).click(chginput);<span class="comment">//因為是後來生成的 HTML，你必須重新使 DOM 路徑被認識（或者走 HTML 的 onclick 比較快）</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* $.Ajax 完整寫法 */</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">  type: <span class="string">"POST"</span>,</span><br><span class="line">  data: &#123;start&#125;,</span><br><span class="line">  url: <span class="string">"api.php?do=select"</span>,</span><br><span class="line">  success: <span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"tbody"</span>).html(result);</span><br><span class="line">    $(<span class="string">".mdy"</span>).click(chginput);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>大致原理為，我們能將資料請求出來並將回傳的所有資訊直接替換 tbody 的 HTML 內容</li>
<li>此外，因配合新生成的 DOM 還沒有事件偵測，所以重新指定點擊事件，將預告指定給 chginput 函式</li>
<li>為了完整性練習，這裡先把第 1 步驟的 Ajax 使用 loading 包住，透過函式運行來達到載入效果。</li>
<li>我們可以控制每次載入幾筆，所以另外可以設計一個按鈕去觸發 loading 就能十筆的載入更多。<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*select*/</span></span><br><span class="line"><span class="keyword">let</span> start = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loading</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $.post(<span class="string">"api.php?do=select"</span>, &#123; start &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="string">"fail"</span>) &#123;</span><br><span class="line">      $(<span class="string">"tbody"</span>).append(result);</span><br><span class="line">      $(<span class="string">".mdy"</span>).click(chginput);<span class="comment">//因為是後來生成的 HTML，你必須重新使 DOM 路徑被認識（或者走 HTML 的 onclick 比較快）</span></span><br><span class="line">      start += <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">loading();</span><br></pre></td></tr></table></figure></li>
<li>再來是規劃 table footer 區域，這裡放入 loading() 觸發紐，另可預先做好新增按鈕。<figure class="highlight html"><figcaption><span>index.html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tfoot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"6"</span> <span class="attr">style</span>=<span class="string">"text-align: center;padding:10px"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"activeForm()"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"loading()"</span>&gt;</span>加載<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>目前為止你已經能完成 Ajax 的資料請求 (select)，其整個流程為：<ul>
<li>使用者請求一個 HTML 文件到前端瀏覽器，該 HTML 只有乾淨的 table</li>
<li>由 Ajax 請求資料到另一個 api.php 但網頁使用者並不知道此事。（可透過 Chrome 開發工具 Network 查詢）</li>
<li>再不進行網頁重載情況下，Ajax 的結果會進行 DOM 替換。</li>
<li>使用者取得了具備資料結構的內容。</li>
</ul>
</li>
</ol>
<h2 id="UPDATE-篇：Ajax-資料處理"><a href="#UPDATE-篇：Ajax-資料處理" class="headerlink" title="UPDATE 篇：Ajax 資料處理"></a>UPDATE 篇：Ajax 資料處理</h2><p>我們先練習 UPDATE 部分，我們透過前一章節的練習繼續接著處理。如何透過 Ajax 幫我們進行資料提供給後端程式進行 SQL 更新。</p>
<ol>
<li>前一章節的練習，我們有預先指定每次點擊修改按鈕時會觸發 chginput 函式。</li>
<li>此函式重點是將純文字轉變成 input 格式。將同個 tr 內，除了自己其他 td 都列為變數 item 代用</li>
<li>利用 this 或 item 對象，找到 tr 位置，並直接整個 tr&gt;td 替換掉。</li>
<li>td 替換透過 itiem.eq() 來進行 text 轉 input:value</li>
<li>最後補上一個儲存按鈕，為了省去因新 DOM 需要重新綁定 click 事件，透過 onclick 直接寫好。<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*update before DOM transform*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chginput</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> item = $(<span class="keyword">this</span>).parent().siblings();</span><br><span class="line">  item.parent().html(<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;td&gt;&lt;input type="hidden" name="id" value="<span class="subst">$&#123;item.eq(<span class="number">0</span>).text()&#125;</span>"&gt;<span class="subst">$&#123;item.eq(<span class="number">0</span>).text()&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;td&gt;&lt;input type="text" name="name" value="<span class="subst">$&#123;item.eq(<span class="number">1</span>).text()&#125;</span>"&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;td&gt;&lt;input type="text" name="weight" value="<span class="subst">$&#123;item.eq(<span class="number">2</span>).text()&#125;</span>"&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;td&gt;&lt;input type="text" name="info" value="<span class="subst">$&#123;item.eq(<span class="number">3</span>).text()&#125;</span>"&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;td&gt;<span class="subst">$&#123;item.eq(<span class="number">4</span>).text()&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;td&gt;</span></span><br><span class="line"><span class="string">      &lt;button onclick="chgtxt(this)"&gt;儲存&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/td&gt;</span></span><br><span class="line"><span class="string">  `</span>);</span><br><span class="line">  <span class="comment">//像這裡就直接指定 onclick，否則你必須要在宣告一次 click</span></span><br><span class="line">  <span class="comment">//HTML 的 onclick 不像 js event 事件能自身帶 this，所以要塞入 this 才能傳遞</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>當使用者按下儲存時，我們需要提交 Ajax 出去給後端做 SQL 更新。</li>
<li>這裡因為資料為多筆，所以需要以物件型態傳遞。但能支援 serialize() 打包函式。<ul>
<li>serialize() 能幫你把多筆資料做成 GET 參數</li>
<li>你可以試著 consol.log(data) 理解透過 serialize() 會得到甚麼</li>
<li>雖然是 URL 參數 (GET)，但 jQuery’s Ajax 會聰明的幫你轉成物件參數</li>
</ul>
</li>
<li>接著透過 Ajax 成功的將資料交由後端處理，此時你應該等到回傳後確定更新成功才適合作畫面更新</li>
<li>由於還有更新時間，我們希望後端能告訴我們 cdate 值</li>
<li>畫面更新時，重新將目前 input.val 變回新值 text 並重新翻新 DOM 與 click 事件綁定<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*update after DOM transform*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chgtxt</span>(<span class="params">who</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = $(who).parents(<span class="string">"tr"</span>).find(<span class="string">"input"</span>).serialize();</span><br><span class="line">  $.post(<span class="string">"api.php?do=update"</span>, data, <span class="function"><span class="keyword">function</span> (<span class="params">cdate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> item = $(who).parent().siblings();</span><br><span class="line">    <span class="keyword">const</span></span><br><span class="line">      id = item.eq(<span class="number">0</span>).text(),</span><br><span class="line">      name = item.eq(<span class="number">1</span>).children().val(),</span><br><span class="line">      weight = item.eq(<span class="number">2</span>).children().val(),</span><br><span class="line">      info = item.eq(<span class="number">3</span>).children().val();</span><br><span class="line"></span><br><span class="line">    item.parent().html(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;td&gt;<span class="subst">$&#123;id&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;<span class="subst">$&#123;name&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;<span class="subst">$&#123;weight&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;<span class="subst">$&#123;info&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;<span class="subst">$&#123;cdate&#125;</span>&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;</span></span><br><span class="line"><span class="string">        &lt;button class="mdy"&gt;修改&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;button onclick="del(this)"&gt;刪除&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/td&gt;</span></span><br><span class="line"><span class="string">    `</span>);</span><br><span class="line">    $(<span class="string">".mdy"</span>).click(chginput);<span class="comment">//這裡新的 HTML 已經跟前面出現過的脫節，所以還要重新再綁一次</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>此時整個畫面操作試試，你已經能正常更新內容，即使畫面重整也不會出問題。</li>
</ol>
<h2 id="DELETE-篇：Ajax-資料處理"><a href="#DELETE-篇：Ajax-資料處理" class="headerlink" title="DELETE 篇：Ajax 資料處理"></a>DELETE 篇：Ajax 資料處理</h2><p>這裡再多練習一次資料處理，透過 Ajax 我們可以完成委託後端來協助 SQL 資料移除。</p>
<ol>
<li>規劃刪除按鈕動作能導向到 del(this)，這裡直接使用 HTML 的 onclick 來處理省事。</li>
<li>透過 this 位置，我們要找到同排第一個欄位內容 id。</li>
<li>data 部分使用 JSON，可以塞變數 <code>{Variables}</code>或 <code>{name:value}</code>，單一個資料傳遞不能直接使用變數。</li>
<li>如果刪除成功後端會提供內容給前端，如果偵測到有內容回傳代表刪除成功，DOM 直接 remove() 就好</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*delete*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">del</span>(<span class="params">who</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> id = $(who).parent().siblings().eq(<span class="number">0</span>).text();</span><br><span class="line">  <span class="comment">// $.post("api.php?do=delete",&#123;"id":id&#125;,function(result)&#123; //DATA=JSON</span></span><br><span class="line">  $.post(<span class="string">"api.php?do=delete"</span>, &#123; id &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (result) $(who).parent().parent().remove(); <span class="comment">//有回傳才做事</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="INSERT-篇：Ajax-資料提交"><a href="#INSERT-篇：Ajax-資料提交" class="headerlink" title="INSERT 篇：Ajax 資料提交"></a>INSERT 篇：Ajax 資料提交</h2><p>新增方式跟修改大同小異，主要差別於前端你該用怎樣的畫面呈現資料輸入。我們需要設計一個上層覆蓋的區域進行簡易欄位。</p>
<ol>
<li>提供新增表單的 HTML 代碼位置，找到任一處新增 div 並設定相關 CSS 屬性。先指定不顯示，之後透過 jQuery FadeIn 呈現<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.insertzone</span> &#123;</span></span><br><span class="line">    position: fixed;</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#333333AA</span>;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex-basis: 50%;</span><br><span class="line">    color: white;</span><br><span class="line">    font-weight: bolder;</span><br><span class="line">    text-align: center;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.insertzone</span>&gt;<span class="selector-tag">form</span> &#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"insertzone"</span> <span class="attr">style</span>=<span class="string">"display: none;"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    這裡不先寫好 HTML 是因為我們網頁不會重整，因此第二次進行新增時 HTML 子元素需要清掉</span></span><br><span class="line"><span class="comment">    因此直接由 JavaScript 來設計較適宜</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>透過新增大按鈕觸發函式 <code>activeForm</code>，這裡會生成 HTML 進行淡入。</li>
<li>如果使用者想取消，我們需要幫助淡出，但 form 可以不用特別清除，下次淡入前都會覆蓋該 HTML<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*insert*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">activeForm</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">".insertzone"</span>).html(<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;form action=""&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;新增動物資料&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;hr&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;動物：&lt;input type="text" name="name"&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;重量：&lt;input type="text" name="weight"&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;簡介：&lt;input type="text" name="info"&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;hr&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;</span></span><br><span class="line"><span class="string">      &lt;!-- 注意 button 沒有 type 會形同 submit --&gt;</span></span><br><span class="line"><span class="string">      &lt;button type="button" onclick="sendForm(this)"&gt;新增&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;button type="button" onclick="closeAddform()"&gt;取消&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;/form&gt;</span></span><br><span class="line"><span class="string">  `</span>);</span><br><span class="line">  $(<span class="string">".insertzone"</span>).fadeIn();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closeAddform</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">".insertzone"</span>).fadeOut();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>當使用者送出時，因為我們使用 Ajax 進行提交。所以能不使用 form 的 submit 功能（甚至你可以不用 form 了），使用 DOM 進行資料收集再改由 Ajax 發送。</li>
<li>然而有使用分流加載的關係，所以這裡乾脆重新撈取資料。否則考量的狀況會分為目前是否再最後的加載而是否調整 DOM，需要更多機制去判斷。<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendForm</span>(<span class="params">who</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = $(who).parents(<span class="string">"form"</span>).find(<span class="string">"input"</span>).serialize();</span><br><span class="line">  $.post(<span class="string">"api.php?do=insert"</span>, data, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//由於是分流載入而考慮情況較多。最快就是歸零重新載入初始 select</span></span><br><span class="line">    $(<span class="string">"tbody"</span>).empty();</span><br><span class="line">    start = <span class="number">0</span>;</span><br><span class="line">    loading();</span><br><span class="line">    $(<span class="string">".insertzone"</span>).fadeOut();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>到目前為止你能清楚知道，Ajax 主要是取代了傳統表單遞交（需重新加載畫面）的處理。將一切資料再背後偷偷額外遞交執行，前端只需 DOM 重新變化調整就好，不需要重新加載網頁。好處是能讓網頁靈活且將效能歸入給使用者環境，也能減少伺服器負擔（只需處理局部資料做傳遞，省下 request 全 HTML 的流量與效能）。</p>
<div class="note default">
            <p><strong>以上完整代碼：</strong> <a href="https://gist.github.com/summer10920/94a9b3385ed7940b88ccc44e3b36a11e" target="_blank" rel="noopener">view page code</a></p>
          </div>

<hr>
<h1 id="網乙練習"><a href="#網乙練習" class="headerlink" title="網乙練習"></a>網乙練習</h1><p>網頁設計乙級會出現經典常見的網站設計範例，這裡額外帶網頁設計乙級解析會用到的 Ajax 資料處理。其中 Q3T8 跟 Q4T5 雷同，我們僅練習一項即可。由於牽扯到資料庫存取，這裡需要額外建立練習用資料表。</p>
<h2 id="題組三：T8-下拉選單對應"><a href="#題組三：T8-下拉選單對應" class="headerlink" title="題組三：T8 下拉選單對應"></a>題組三：T8 下拉選單對應</h2><p>主要是針對有相對應的三組下拉選單，分別是電影場次-&gt;日期-&gt;時間 （含剩餘座位）。這裡練習項目稍作修改，不考慮電影上下檔日期情況下做以下微調</p>
<ol>
<li>開放日期選擇（含今日）之一周預約，以及場次時間</li>
<li>場次開放 10~22，2 小時一場共 7 場，超過販售時間則不顯示</li>
</ol>
<h3 id="後端處理"><a href="#後端處理" class="headerlink" title="後端處理"></a>後端處理</h3><p>如果你本身已會 PHP 技能可自行參考本事前準備之相關環境，否則請於上課時採用老師的後端環境（由老師提供後端環境）。原需要由後端程式去跟資料庫進行資料撈取行為，這裡簡化為已經取得並持有相關陣列數據，將不再示範如何連接資料庫。大致上 PHP 之初始資料陣列資料如下：</p>
<p><strong>電影名稱與 ID</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>title</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>電影名稱 A</td>
</tr>
<tr>
<td>2</td>
<td>電影名稱 B</td>
</tr>
<tr>
<td>3</td>
<td>電影名稱 C</td>
</tr>
</tbody></table>
<p><strong>電影上映日狀況</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>movie</th>
<th>date</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>2020-05-05</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2020-05-06</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>2020-05-06</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
<td>2020-05-07</td>
</tr>
<tr>
<td>5</td>
<td>3</td>
<td>2020-05-07</td>
</tr>
<tr>
<td>6</td>
<td>3</td>
<td>2020-05-08</td>
</tr>
</tbody></table>
<p><strong>電影銷售狀況</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>movieDay</th>
<th>time</th>
<th>sellout</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>8</td>
<td>3</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>9</td>
<td>3</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>10</td>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>11</td>
<td>4</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>12</td>
<td>4</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>13</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>14</td>
<td>5</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>15</td>
<td>5</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>16</td>
<td>5</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>17</td>
<td>6</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>18</td>
<td>6</td>
<td>2</td>
<td>2</td>
</tr>
</tbody></table>
<p>而後端能提供三種請求方式：</p>
<ul>
<li>根據 <code>?do=getmovie</code> 提供電影名稱與索引 ID 之數據，為 JSON 字串</li>
<li>根據 <code>?do=getdate&amp;id=</code> 提供指定電影 id 之電影名稱上映日之數據，為 JSON 字串</li>
<li>根據 <code>?do=gettime&amp;id=</code> 提供指定電影放送日 id 之場次之數據，為 JSON 字串</li>
</ul>
<p>後端代碼如下：</p>
<figure class="highlight php"><figcaption><span>api.php</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$movieName = <span class="keyword">array</span>(</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">1</span>, <span class="string">"movie"</span> =&gt; <span class="string">"電影名稱 A"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">2</span>, <span class="string">"movie"</span> =&gt; <span class="string">"電影名稱 B"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">3</span>, <span class="string">"movie"</span> =&gt; <span class="string">"電影名稱 C"</span>),</span><br><span class="line">);</span><br><span class="line">$movieDay = <span class="keyword">array</span>(</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">1</span>, <span class="string">"movieName"</span> =&gt; <span class="number">1</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-05"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">2</span>, <span class="string">"movieName"</span> =&gt; <span class="number">1</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-06"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">3</span>, <span class="string">"movieName"</span> =&gt; <span class="number">2</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-06"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">4</span>, <span class="string">"movieName"</span> =&gt; <span class="number">2</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-07"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">5</span>, <span class="string">"movieName"</span> =&gt; <span class="number">3</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-07"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">6</span>, <span class="string">"movieName"</span> =&gt; <span class="number">3</span>, <span class="string">"date"</span> =&gt; <span class="string">"2020-05-08"</span>)</span><br><span class="line">);</span><br><span class="line">$movieOrder = <span class="keyword">array</span>(</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">1</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">1</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">2</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">1</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">3</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">1</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">4</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">1</span>, <span class="string">"time"</span> =&gt; <span class="number">4</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">5</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">2</span>, <span class="string">"time"</span> =&gt; <span class="number">1</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">6</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">2</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">7</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">2</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">8</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">3</span>, <span class="string">"time"</span> =&gt; <span class="number">1</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">9</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">3</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">10</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">3</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">11</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">4</span>, <span class="string">"time"</span> =&gt; <span class="number">1</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">12</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">4</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">13</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">4</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">14</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">5</span>, <span class="string">"time"</span> =&gt; <span class="number">1</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">15</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">5</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">16</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">5</span>, <span class="string">"time"</span> =&gt; <span class="number">3</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">17</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">6</span>, <span class="string">"time"</span> =&gt; <span class="number">1</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">18</span>, <span class="string">"movieDay"</span> =&gt; <span class="number">6</span>, <span class="string">"time"</span> =&gt; <span class="number">2</span>, <span class="string">"sellout"</span> =&gt; <span class="number">2</span>),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">'do'</span>]) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'getmovie'</span>:</span><br><span class="line">    <span class="comment">//這裡將提供 JSON 給前端，由前端來處理 DOM (JSON_UNESCAPED_UNICODE 能確保中文，非必要因 HTML 能正常顯示 unicode)</span></span><br><span class="line">    <span class="keyword">echo</span> json_encode($movieName, JSON_UNESCAPED_UNICODE);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span> <span class="string">'getdate'</span>:</span><br><span class="line">    $result = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">foreach</span> ($movieDay <span class="keyword">as</span> $row) <span class="keyword">if</span> ($row[<span class="string">'movieName'</span>] == $_GET[<span class="string">'id'</span>]) array_push($result, $row);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($result, JSON_UNESCAPED_UNICODE);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span> <span class="string">'gettime'</span>:</span><br><span class="line">    $result = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">foreach</span> ($movieOrder <span class="keyword">as</span> $row) <span class="keyword">if</span> ($row[<span class="string">'movieDay'</span>] == $_GET[<span class="string">'id'</span>]) array_push($result, $row);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($result, JSON_UNESCAPED_UNICODE);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="前端設計"><a href="#前端設計" class="headerlink" title="前端設計"></a>前端設計</h3><ol>
<li>先建立好版型，畫面提供三組 select 下拉選單</li>
<li>設定電影與日期當 value 變化 (onchange) 時能執行指定函式，這樣每次用戶更改欄位都能觸發次選單的翻新。<figure class="highlight html"><figcaption><span>q3t8.html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">  電影：<span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"mm"</span> <span class="attr">id</span>=<span class="string">"sm"</span> <span class="attr">onchange</span>=<span class="string">"gd()"</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  日期：<span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"dd"</span> <span class="attr">id</span>=<span class="string">"sd"</span> <span class="attr">onchange</span>=<span class="string">"gt()"</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  場次：<span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"tt"</span> <span class="attr">id</span>=<span class="string">"st"</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"確定"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>除了電影，其他選單先不提供 option，強迫用戶先選電影再做其他指定。</li>
<li>電影資料來自後端提供，由於資料未處理，需於 JavaScript 進行 DOM 修改<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 資料初始化 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// $.getJSON("api.php?do=getmovie",function(result)&#123;</span></span><br><span class="line"><span class="comment">//   console.log(typeof(result));</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">$.<span class="keyword">get</span>("api.php", &#123; <span class="string">"do"</span>: <span class="string">"getmovie"</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">typeof</span> (result)); <span class="comment">//$.get 拿到的是字串而不是物件，所以還要轉檔一下，或者使用$.getJSON 方式取得</span></span><br><span class="line">  result = <span class="built_in">JSON</span>.parse(result);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> content = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> row <span class="keyword">of</span> result) &#123;</span><br><span class="line">    content += <span class="string">`&lt;option value="<span class="subst">$&#123;row[<span class="string">"id"</span>]&#125;</span>"&gt;<span class="subst">$&#123;row[<span class="string">"movie"</span>]&#125;</span>&lt;/option&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  $(<span class="string">"#sm"</span>).html(content);</span><br><span class="line"></span><br><span class="line">  gd();<span class="comment">//確保第一次自動 DOM 生成時，也能提供日期 option</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>當電影變化時或觸發此函式時，能提供日期 option 項目。</li>
<li>資料需要自行整理成 HTML 進行 DOM 修改。<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*根據目前所選之電影，進行可販售日期*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gd</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> mv = $(<span class="string">"#sm"</span>).val();</span><br><span class="line">  $.<span class="keyword">get</span>("api.php", &#123; <span class="string">"do"</span>: <span class="string">"getdate"</span>, <span class="string">"id"</span>: mv &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    result = <span class="built_in">JSON</span>.parse(result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> content = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> row <span class="keyword">of</span> result) content += <span class="string">`&lt;option value="<span class="subst">$&#123;row[<span class="string">"id"</span>]&#125;</span>"&gt;<span class="subst">$&#123;row[<span class="string">"date"</span>]&#125;</span>&lt;/option&gt;`</span>;</span><br><span class="line">    $(<span class="string">"#sd"</span>).html(content);</span><br><span class="line"></span><br><span class="line">    gt();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>同樣觸發 gt 函式，向後端請求指定電影放送日之銷售狀況。</li>
<li>資料為銷售狀況，由前端進行判斷處理計算出所有時段之已售數量為何。</li>
<li>先設計一個資料陣列 time 做資料紀錄且初始化。後端指定的 1 ~ 7 場次，在前端代表 0 ~ 6 需特別注意。</li>
<li>透過迴圈檢查訂單，將找到的各時段賣票數累加回我們紀錄。</li>
<li>此外，不合理的時間場次需要忽略顯示，如果播放日為今天且時間場次已過期都要忽略顯示。<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*根據目前所選之電影與販售日期，進行票數之計算*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> dv = $(<span class="string">"#sd"</span>).val();</span><br><span class="line">  $.<span class="keyword">get</span>("api.php", &#123; <span class="string">"do"</span>: <span class="string">"gettime"</span>, <span class="string">"id"</span>: dv &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    result = <span class="built_in">JSON</span>.parse(result);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*由於後端給的資料為結果之全數據，所以我們要自己計算各場次之剩餘座位*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//各時段的總銷售數初始化 </span></span><br><span class="line">    <span class="keyword">let</span> time = [</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"10:00~12:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"12:00~14:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"14:00~16:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"16:00~18:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"18:00~20:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"20:00~22:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">txt</span>: <span class="string">"22:00~24:00"</span>, <span class="attr">ticketlast</span>: <span class="number">20</span> &#125;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> row <span class="keyword">of</span> result) &#123;</span><br><span class="line">      time[row[<span class="string">'time'</span>] - <span class="number">1</span>].ticketlast -= row[<span class="string">'sellout'</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> content = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//10=&gt;1, 11=&gt;1, 12=&gt;2, 13=&gt;2, 14=&gt;3, ~~&gt; x=&gt;y | y = (x/2) 無條件捨去 - 4</span></span><br><span class="line">    <span class="keyword">let</span> TimetoNun = <span class="built_in">Math</span>.floor(nowTime.getHours() / <span class="number">2</span>) - <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> selectDayA = <span class="keyword">new</span> <span class="built_in">Date</span>($(<span class="string">"#sd option:selected"</span>).text()).toDateString();</span><br><span class="line">    <span class="comment">//toDateString() =&gt; Thu May 07 2020</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> row <span class="keyword">of</span> time) &#123;</span><br><span class="line">      count++;</span><br><span class="line">      <span class="keyword">if</span> (count &lt;= TimetoNun &amp;&amp; selectDay == nowTime.toDateString()) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// like &lt;option value="2"&gt;12:00~14:00 剩餘座位 5 &lt;/option&gt;</span></span><br><span class="line">      content += <span class="string">`&lt;option value="<span class="subst">$&#123;count&#125;</span>"&gt;<span class="subst">$&#123;row.txt&#125;</span> 剩餘座位 <span class="subst">$&#123;row.ticketlast&#125;</span> &lt;/option&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $(<span class="string">"#st"</span>).html(content);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>完成後，請嘗試於前端點選今日場次結果，且調整幾筆持有今日的放映日測試。</li>
<li>你可以規劃更完善，譬如直接按下送出（未選擇電影），要如何判斷無效輸入並取消表單。</li>
</ol>
<h2 id="題組四：T7-註冊帳號驗證"><a href="#題組四：T7-註冊帳號驗證" class="headerlink" title="題組四：T7 註冊帳號驗證"></a>題組四：T7 註冊帳號驗證</h2><p>每次進行帳號註冊前，先透過 Ajax 進行現有帳號之檢查。如果可用此帳號則允許表單提交。</p>
<h3 id="後端規劃"><a href="#後端規劃" class="headerlink" title="後端規劃"></a>後端規劃</h3><ol>
<li>需要先建立一些資料，方便我們練習時進行資料庫比對</li>
<li>主要是提供前端做檢查是否帳號存在，並提供適合的畫面回應</li>
</ol>
<table>
<thead>
<tr>
<th>id</th>
<th>acc</th>
<th>pwd</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>admin</td>
<td>1234</td>
</tr>
<tr>
<td>2</td>
<td>loki</td>
<td>4321</td>
</tr>
</tbody></table>
<figure class="highlight php"><figcaption><span>api.php(php)</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">/*q4t7 start*/</span></span><br><span class="line">$account=<span class="keyword">array</span>(</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">1</span>, <span class="string">"acc"</span> =&gt; <span class="string">"admin"</span>, <span class="string">"pwd"</span> =&gt; <span class="string">"1234"</span>),</span><br><span class="line">  <span class="keyword">array</span>(<span class="string">"id"</span> =&gt; <span class="number">2</span>, <span class="string">"acc"</span> =&gt; <span class="string">"loki"</span>, <span class="string">"pwd"</span> =&gt; <span class="string">"4321"</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">'do'</span>]) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'checkuser'</span>:</span><br><span class="line">    $flag = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">foreach</span> ($account <span class="keyword">as</span> $row) <span class="keyword">if</span> ($row[<span class="string">'acc'</span>] == $_POST[<span class="string">'acc'</span>]) &#123;</span><br><span class="line">      $flag = <span class="keyword">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($flag) <span class="keyword">echo</span> <span class="string">"帳號重複"</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"可使用此帳號"</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="前端設計-1"><a href="#前端設計-1" class="headerlink" title="前端設計"></a>前端設計</h3><ol>
<li>版型規劃，新增 q4t7.html</li>
<li>表單做 onsubmit 進行表單提交時執行函式，如果遇到 return false 會取消提交。</li>
<li>帳號檢查按鈕，進行 Ajax 的驗證。</li>
<li>另外針對 acc 欄位做 onchange 功能，設計一個 flag 做審核機關。</li>
<li>只有 flag 變為 1 才允許表單通過，否則請做帳號驗證（避免偷渡）<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>註冊帳號<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"get"</span> <span class="attr">onsubmit</span>=<span class="string">"return checkflag()"</span>&gt;</span></span><br><span class="line">  姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  帳號：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"acc"</span> <span class="attr">onchange</span>=<span class="string">"flag=0"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"檢測帳號"</span> <span class="attr">onclick</span>=<span class="string">"check()"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  密碼：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"確認"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>check 負責提交後端做帳號判斷，如果帳號可使用，將 flag 設為 1</li>
<li>checkflag 是負責表單提交的審查，如果 flag 是 0 則不允許提交<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> flag = <span class="number">0</span>; <span class="comment">//0=未檢測，1=已檢測</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> acc = $(<span class="string">"input[name=acc]"</span>).val();</span><br><span class="line">  $.post(<span class="string">"api.php?do=checkuser"</span>, &#123; acc &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">re</span>) </span>&#123;</span><br><span class="line">    alert(re);</span><br><span class="line">    flag = (re == <span class="string">"可使用此帳號"</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    alert(<span class="string">"請先驗證帳號"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<div class="note default">
            <p><strong>以上兩題之完整代碼：</strong> <a href="https://gist.github.com/summer10920/e70cd0ce7380fc9f89a92059feb8b46a" target="_blank" rel="noopener">view full code</a></p>
          </div>

<h1 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h1><p>Ajax 屬於 JavaScript 的原領域內，能允許外部位置載入網頁（本課程不做介紹練習）。而 JQuery 的 Ajax 功能更完善便利，能快速適用任何動態資料進行 API 串接。同時透過本篇概念你能清楚知道 Ajax 能輕易串接到伺服器後端請求取得，同理來說 OpenData 也是相同的串接做法。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PHP-%E8%B3%87%E6%96%99%E5%BA%AB%E7%B6%B2%E9%A0%81%E8%A8%AD%E8%A8%88%EF%BC%88%E8%81%B7%E5%89%8D%E7%8F%AD%EF%BC%89/" rel="tag"># PHP 資料庫網頁設計（職前班）</a>
              <a href="/tags/JavaScript-%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%EF%BC%88%E5%81%87%E6%97%A5%E7%8F%AD%EF%BC%89/" rel="tag"># JavaScript 程式設計（假日班）</a>
              <a href="/tags/%E5%89%8D%E7%AB%AF%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC%E6%8A%80%E8%A1%93%EF%BC%88%E8%81%B7%E5%89%8D%E7%8F%AD%EF%BC%89/" rel="tag"># 前端網頁開發技術（職前班）</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04-23/jq-sampleclass-1/" rel="prev" title="[練習課程] jQuery 基礎實作（一）：網頁乙級相關範例">
      <i class="fa fa-chevron-left"></i> [練習課程] jQuery 基礎實作（一）：網頁乙級相關範例
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/05-08/jq-opendata/" rel="next" title="[練習課程] jQuery 基礎實作（二）：OpenData API 串接">
      [練習課程] jQuery 基礎實作（二）：OpenData API 串接 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          關於本站
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#語法說明"><span class="nav-number">1.</span> <span class="nav-text">語法說明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#get-vs-post"><span class="nav-number">1.1.</span> <span class="nav-text">$.get() vs $.post()</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#題目練習"><span class="nav-number">2.</span> <span class="nav-text">題目練習</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#版型規劃與前置作業"><span class="nav-number">2.1.</span> <span class="nav-text">版型規劃與前置作業</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#後端準備"><span class="nav-number">2.1.1.</span> <span class="nav-text">後端準備</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端準備"><span class="nav-number">2.1.2.</span> <span class="nav-text">前端準備</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT-篇：Ajax-資料請求"><span class="nav-number">2.2.</span> <span class="nav-text">SELECT 篇：Ajax 資料請求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE-篇：Ajax-資料處理"><span class="nav-number">2.3.</span> <span class="nav-text">UPDATE 篇：Ajax 資料處理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE-篇：Ajax-資料處理"><span class="nav-number">2.4.</span> <span class="nav-text">DELETE 篇：Ajax 資料處理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT-篇：Ajax-資料提交"><span class="nav-number">2.5.</span> <span class="nav-text">INSERT 篇：Ajax 資料提交</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#網乙練習"><span class="nav-number">3.</span> <span class="nav-text">網乙練習</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#題組三：T8-下拉選單對應"><span class="nav-number">3.1.</span> <span class="nav-text">題組三：T8 下拉選單對應</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#後端處理"><span class="nav-number">3.1.1.</span> <span class="nav-text">後端處理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端設計"><span class="nav-number">3.1.2.</span> <span class="nav-text">前端設計</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#題組四：T7-註冊帳號驗證"><span class="nav-number">3.2.</span> <span class="nav-text">題組四：T7 註冊帳號驗證</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#後端規劃"><span class="nav-number">3.2.1.</span> <span class="nav-text">後端規劃</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端設計-1"><span class="nav-number">3.2.2.</span> <span class="nav-text">前端設計</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#總結"><span class="nav-number">4.</span> <span class="nav-text">總結</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Loki Jiang"
      src="/images/loki_img.jpg">
  <p class="site-author-name" itemprop="name">Loki Jiang</p>
  <div class="site-description" itemprop="description">Time waits for no oneヽ(｀Д´)ﾉ</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/summer10920" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;summer10920" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:summer10920@gmail.com" title="E-Mail → mailto:summer10920@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://codepen.io/summer10920/pens/public" title="CodePen → https:&#x2F;&#x2F;codepen.io&#x2F;summer10920&#x2F;pens&#x2F;public" rel="noopener" target="_blank"><i class="fa fa-fw fa-codepen"></i>CodePen</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Loki Jiang</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="訪客總數">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="總瀏覽次數">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

</body>
</html>
